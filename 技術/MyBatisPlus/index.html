<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/twelvefish.png" />
    

    <title>
        
          twelvefish
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre-exp.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.9/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

<meta name="generator" content="Hexo 6.1.0"></head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/twelvefish.png">
    <span>twelvefish</span>
  </a>
</div>
    <div id="menu" class="book-menu hide">
  <h2 id="技術"><a href="#技術" class="headerlink" title="技術"></a>技術</h2><ul>
<li><a href="/技術/Linux&Shell" class="current-tab">Linux &amp; Shell</a></li>
<li><a href="/技術/MyBatisPlus" class="current-tab">MyBatisPlus</a><!-- - <a href="/技術/谷粒商城" class="current-tab">谷粒商城</a> --></li>
</ul>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h2 id="專題"><a href="#專題" class="headerlink" title="專題"></a>專題</h2><!-- - <a href="/技術/ElasticSearch實戰" class="current-tab">ElasticSearch實戰</a> -->
<!-- - <a href="/技術/TypeScript大戰貪食蛇" class="current-tab">TypeScript大戰貪食蛇</a> -->

<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h2 id="小說"><a href="#小說" class="headerlink" title="小說"></a>小說</h2><ul>
<li><a href="/小說/古之惡來者為王" class="current-tab">古之惡來者為王</a></li>
<li><a href="/小說/喝杯酒，說個故事" class="current-tab">喝杯酒，說個故事</a></li>
<li><a href="/小說/末日之勇者勝" class="current-tab">末日之勇者勝</a></li>
<li><a href="/小說/莫名的愛" class="current-tab">莫名的愛</a></li>
<li><a href="/小說/致，我生命中邂逅的女人們" class="current-tab">致，我生命中邂逅的女人們</a></li>
</ul>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h1 id="版主履歷"><a href="#版主履歷" class="headerlink" title="版主履歷"></a><a href="/版主履歷" class="current-tab">版主履歷</a></h1>
</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
  <div class="sidebar-toggle-inner"></div>
</div>

<script>
function add_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.add('show')  
}

function remove_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.remove('show')
}

function sidebar_toggle() {
    let sidebar_toggle = document.querySelector('.sidebar-toggle')
    let sidebar = document.querySelector('.book-sidebar')
    let content = document.querySelector('.off-canvas-content')
    if (sidebar_toggle.classList.contains('extend')) { // show
        sidebar_toggle.classList.remove('extend')
        sidebar.classList.remove('hide')
        content.classList.remove('extend')
    }
    else { // hide
        sidebar_toggle.classList.add('extend')
        sidebar.classList.add('hide')
        content.classList.add('extend')
    }
}
</script>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <h2 id="MyBatisPlus"><a href="#MyBatisPlus" class="headerlink" title="MyBatisPlus"></a>MyBatisPlus</h2><h2 id="簡介"><a href="#簡介" class="headerlink" title="簡介"></a>簡介</h2><h2 id="1、引入依賴"><a href="#1、引入依賴" class="headerlink" title="1、引入依賴"></a>1、引入依賴</h2><p><img src="/img/MyBatisPlus+/06.PNG"></p>
<h2 id="2、application-yml配置"><a href="#2、application-yml配置" class="headerlink" title="2、application.yml配置"></a>2、application.yml配置</h2><ul>
<li>spring boot 2.1及以上（内置jdbc8驅動），驅動類使用 driver-class-name: com.mysql.cj.jdbc.Driver</li>
<li>spring boot 2.0（内置jdbc5驅動），驅動類使用：driver-class-name: com.mysql.jdbc.Driver</li>
<li>MySQL5.7版本的url : jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;mybatis_plus?characterEncoding&#x3D;utf-8&amp;useSSL&#x3D;false</li>
<li>MySQL8.0版本的url：jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;mybatis_plus?serverTimezone&#x3D;GMT%2B8&amp;characterEncoding&#x3D;utf-8&amp;useSSL&#x3D;false</li>
<li>於MyBatisPlus中配置log-impl會於日誌中自動產生使用的SQL語法<ul>
<li>mybatis-plus.configuration.log-impl: org.apache.ibatis.logging.stdout.StdOutImpl<br><img src="/img/MyBatisPlus+/07.PNG"></li>
</ul>
</li>
</ul>
<h2 id="3、lombok"><a href="#3、lombok" class="headerlink" title="3、lombok"></a>3、lombok</h2><ul>
<li>在bean上面設置@NoArgsConstructor，會自動生成無參構造器</li>
<li>@AllArgsConstructor，會自動生成有參構造器</li>
<li>@Getter，會自動生成getter</li>
<li>@Setter，會自動生成setter</li>
<li>@EqualsAndHashCode，會自動生成equal和HashCode</li>
<li>以上全部可以用一個 @Data替代，但是無有參構造<br><img src="/img/MyBatisPlus+/01.PNG"><br><img src="/img/MyBatisPlus+/02.PNG"></li>
</ul>
<h2 id="4、BaseMapper"><a href="#4、BaseMapper" class="headerlink" title="4、BaseMapper"></a>4、BaseMapper</h2><ul>
<li>掃描mapper接口所在的包，在Spring Boot啟動類中添加@MapperScan(“com.twelvefish.MyBatisPlus.mapper”)</li>
<li>藉由繼承BaseMapper來使用MyBatisPlus所提供的各種方法，而泛型能夠映射資料庫，將對應的表資料結構取出</li>
<li>BaseMapper是MyBatisPlus提供的模板mapper，其中包含了基本的CRUD方法，泛型為操作的實體類型</li>
<li>IDEA在 userMapper 報錯，因為找不到注入的對象，因为類是動態創建，但是編譯可以正常執行，但想避免報錯，可以在mapper接口上添加 @Repository 注解</li>
<li>下述截圖範例為使用UserMapper去查詢資料庫中的資料，並query全部資料回來，通過條件構造器查詢一個list集合，若沒有條件，則可設置為null<br><img src="/img/MyBatisPlus+/03.PNG"><br><img src="/img/MyBatisPlus+/04.PNG"><br><img src="/img/MyBatisPlus+/05.PNG"></li>
</ul>
<h2 id="5、多表查詢"><a href="#5、多表查詢" class="headerlink" title="5、多表查詢"></a>5、多表查詢</h2><ul>
<li>自定義的SQL語句預設放在resources&#x2F;mapper底下的xml，或是在yml中自定義路徑<br><img src="/img/MyBatisPlus+/08.PNG"></li>
<li>在繼承BaseMapper的類下增加自定義方法<br><img src="/img/MyBatisPlus+/09.PNG"></li>
<li>自定義方法可自己撰寫SQL語法，搭配xml的id匹配對應的方法名稱<br><img src="/img/MyBatisPlus+/10.PNG"></li>
</ul>
<h2 id="6、Service"><a href="#6、Service" class="headerlink" title="6、Service"></a>6、Service</h2><ul>
<li>MyBatis-Plus中有一個接口 IService和實現類 ServiceImpl，封裝了常見的業務層邏輯</li>
<li>UserService繼承IService模板提供的基礎功能</li>
<li>ServiceImpl實現了IService，提供了IService中基礎功能的實現</li>
<li>若ServiceImpl無法滿足業務需求，則可以使用自定的UserService定義方法，並在實現類中實現<br><img src="/img/MyBatisPlus+/11.PNG"><br><img src="/img/MyBatisPlus+/12.PNG"></li>
</ul>
<h2 id="7、常用註解"><a href="#7、常用註解" class="headerlink" title="7、常用註解"></a>7、常用註解</h2><ul>
<li>@TableName<ul>
<li>在實體類類型上添加@TableName(“XXXX”)，即可標識實體類對應的資料庫表名稱，預設則為第一字母小寫</li>
<li>或是也可以直接在application.yml進行全域配置table-prefix，針對每張表都進行前缀處理，就可以不用每張表都增加@TableName</li>
</ul>
</li>
<li>@TableId<ul>
<li>MyBatisPlus默認將 “id” 作為主鍵，可以使用@TableId此參數，告訴MyBatisPlus此張表的主鍵字串是哪個欄位</li>
<li>但也可以透過@TableId的value屬性，指定表中的主鍵字串，@TableId(value&#x3D;”uid”)</li>
<li>@TableId(type&#x3D;IdType.ASSIGN_ID)（默認），基於雪花算法的策略生成數據id，與資料庫id是否設置自增無關</li>
<li>@TableId(type&#x3D;IdType.AUTO)，使用資料庫的自增策略，注意，該類型請確保資料庫設置了id自增，<br>否則無效</li>
<li>設置統一(每張表)的主鍵生成策略，id-type</li>
</ul>
</li>
<li>@TableField<ul>
<li>mybatis會自動將資料庫裏面的欄位字串，如果有底線，當轉換成資料表時，會進行駝峰轉換，ex: 資料庫裡面user_name，轉換成程式裡面的資料表時，可以取名為userName</li>
<li>可利用 @TableField 於程式碼裡面指定所對應的資料庫欄位</li>
</ul>
</li>
<li>@TableLogic<ul>
<li>邏輯刪除，針對某個欄位設定為0、1，在select時，針對這欄位去判斷，來讓資料感覺上被刪除了，但實際上資料還存在</li>
<li>呼叫查詢方法時，會只查詢此欄位為0的資料，呼叫刪除方法時，只會將此欄位從0變成1，不會真的將資料刪除<br><img src="/img/MyBatisPlus+/13.PNG"><br><img src="/img/MyBatisPlus+/15.PNG"><br><img src="/img/MyBatisPlus+/14.PNG"></li>
</ul>
</li>
</ul>
<h2 id="8、條件構造器-Wrapper"><a href="#8、條件構造器-Wrapper" class="headerlink" title="8、條件構造器 Wrapper"></a>8、條件構造器 Wrapper</h2><ul>
<li><p>Wrapper ： 條件構造抽像類，最頂端父類</p>
<ul>
<li>Abstract    Wrapper ： 用於查詢條件封裝，生成 sql 的 where 條件<ul>
<li>QueryWrapper ： 查詢條件封裝</li>
<li>UpdateWrapper ： Update 條件封裝</li>
<li>AbstractLambdaWrapper ： 使用Lambda 語法<ul>
<li>LambdaQueryWrapper ：用於Lambda語法使用的查詢Wrapper</li>
<li>LambdaUpdateWrapper ： Lambda 更新封裝Wrapper<br><img src="/img/MyBatisPlus+/16.PNG"></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>使用queryWrapper來查詢user中條件為: name字串中有”B”，age&gt;20，age&lt;30，email不為空</p>
<ul>
<li>SELECT id,name,age,email,is_deleted FROM user WHERE is_deleted&#x3D;0 AND (name LIKE ? AND age BETWEEN ? AND ? AND email IS NOT NULL)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testWraper()&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = new QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.like(&quot;name&quot;, &quot;B&quot;)</span><br><span class="line">            .between(&quot;age&quot;,20,30)</span><br><span class="line">            .isNotNull(&quot;email&quot;);</span><br><span class="line">    List&lt;User&gt; list = userMapper.selectList(queryWrapper);</span><br><span class="line">    list.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>藉由lambda來設定條件的優先級，將用戶名中包含有a並且（年齡大於20或郵箱為null）的用戶信息修改</p>
<ul>
<li>UPDATE user SET age&#x3D;?, email&#x3D;? WHERE (name LIKE ? AND (age &gt; ? OR email IS NULL))</li>
<li>lambda表達式內的邏輯優先運算<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testWraper() &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = new QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.like(&quot;name&quot;, &quot;a&quot;)</span><br><span class="line">                .and(i -&gt; i.gt(&quot;age&quot;, 20).or().isNull(&quot;email&quot;));</span><br><span class="line">    User user = new User();</span><br><span class="line">    user.setAge(18);</span><br><span class="line">    user.setEmail(&quot;user@gmail.com&quot;);</span><br><span class="line">    int result = userMapper.update(user, queryWrapper);</span><br><span class="line">    System.out.println(&quot;受影響的行數：&quot; + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>藉由select，只查詢特定的欄位，查詢用戶信息的name和age字段</p>
<ul>
<li>SELECT name,age FROM t_user<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testWraper() &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = new QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.select(&quot;name&quot;, &quot;age&quot;);</span><br><span class="line">    //selectMaps()返回Map集合列表，通常配合select()使用，避免User對像中沒有被查詢到的列值為null</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; maps = userMapper.selectMaps(queryWrapper);</span><br><span class="line">    maps.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>藉由inSql，實現子查詢，查詢id小於等於3的用戶信息</p>
<ul>
<li>SELECT id,name,age,email,is_deleted FROM user WHERE (id IN (select id from user where id &lt;&#x3D; 3))<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testWraper() &#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = new QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.inSql(&quot;id&quot;, &quot;select id from user where id &lt;= 3&quot;);</span><br><span class="line">    List&lt;User&gt; list = userMapper.selectList(queryWrapper);</span><br><span class="line">    list.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>UpdateWrapper，可直接在updateWrapper進行值的設定</p>
<ul>
<li>將（年齡大於20或郵箱為null）並且用戶名中包含有a的用戶信息修改<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">@Test</span><br><span class="line">public void testWraper() &#123;</span><br><span class="line">    UpdateWrapper&lt;User&gt; updateWrapper = new UpdateWrapper&lt;&gt;();</span><br><span class="line">    updateWrapper.set(&quot;age&quot;, 18)</span><br><span class="line">                 .set(&quot;email&quot;, &quot;user@gmail.com&quot;)</span><br><span class="line">                 .like(&quot;name&quot;, &quot;a&quot;)</span><br><span class="line">                 .and(i -&gt; i.gt(&quot;age&quot;, 20).or().isNull(&quot;email&quot;));</span><br><span class="line">    int result = userMapper.update(null, updateWrapper);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>condition，在真正開發的過程中，組裝條件是常見的功能，而這些條件數據來源於用戶輸入，是可選的，因此我們在組裝這些條件時，必須先判斷用戶是否選擇了這些條件，若選擇則需要組裝該條件，若沒有選擇則一定不能組裝，以免影響SQL執行的結果</p>
<ul>
<li>SELECT id,name,age,email,is_deleted FROM user WHERE (age &gt;&#x3D; ? AND age &lt;&#x3D; ?)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testWraper() &#123;</span><br><span class="line">    //定義查詢條件，有可能為null（用戶未輸入或未選擇）</span><br><span class="line">    String name = null;</span><br><span class="line">    Integer ageBegin = 10;</span><br><span class="line">    Integer ageEnd = 24;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = new QueryWrapper&lt;&gt;();</span><br><span class="line">    //StringUtils.isNotBlank()判斷某字符串是否不為空且長度不為0且不由空白符(whitespace)構成</span><br><span class="line">    queryWrapper.like(StringUtils.isNotBlank(name), &quot;name&quot;, &quot;a&quot;)</span><br><span class="line">                .ge(ageBegin != null, &quot;age&quot;, ageBegin)</span><br><span class="line">                .le(ageEnd != null, &quot;age&quot;, ageEnd);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>LambdaQueryWrapper，避免再填寫表的字串名時打錯，可用Lambda來替代</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testWraper() &#123;</span><br><span class="line">    //定義查詢條件，有可能為null（用戶未輸入）</span><br><span class="line">    String name = &quot;a&quot;;</span><br><span class="line">    Integer ageBegin = 10;</span><br><span class="line">    Integer ageEnd = 24;</span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; queryWrapper = new LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">    //避免使用字符串表示字段，防止運行時錯誤</span><br><span class="line">    queryWrapper.like(StringUtils.isNotBlank(name), User::getName, name)</span><br><span class="line">                .ge(ageBegin != null, User::getAge, ageBegin)</span><br><span class="line">                .le(ageEnd != null, User::getAge, ageEnd);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>LambdaUpdateWrapper，避免再填寫表的字串名時打錯，可用Lambda來替代</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void test10() &#123;</span><br><span class="line">    //組裝set子句</span><br><span class="line">    //lambda，表達式內的邏輯優先運算</span><br><span class="line">    LambdaUpdateWrapper&lt;User&gt; updateWrapper = new LambdaUpdateWrapper&lt;&gt;();</span><br><span class="line">    updateWrapper.set(User::getAge, 18)</span><br><span class="line">                 .set(User::getEmail, &quot;user@gmail.com&quot;)</span><br><span class="line">                 .like(User::getName, &quot;a&quot;)</span><br><span class="line">                 .and(i -&gt; i.lt(User::getAge, 24).or().isNull(User::getEmail)); </span><br><span class="line">    User user = new User();</span><br><span class="line">    int result = userMapper.update(user, updateWrapper);</span><br><span class="line">    System.out.println(&quot;受影響的行數：&quot; + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

    <div class="author">
  
      <!-- Author image -->
      <div class="author-img">
        
          <figure class="avatar avatar-lg">
            <img src="/twelvefish.png" alt="...">
          </figure>
        
      </div>
  
      <!-- Author title -->
      <div class="author-title">
        <div>十鱷魚</div>
        <!-- <div>2023-04-05</div> -->
      </div>
    </div>
  
    
  
    <div class="divider"></div>
  </div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
